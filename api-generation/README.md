# API Generation Tools and Templates

A minimal demo of Dapr actors application in Go, demonstrating actor state management and method invocation patterns with schema-first development.

> **Note**: This documentation was largely generated by AI to provide comprehensive examples and explanations.

This directory contains tools, templates, and configurations for schema-first development.

## Overview

This module supports generating Go code from various API schema definitions, enabling schema-first development workflows where:

1. **API schemas are defined first** using standard schema languages
2. **Code is generated** from these schemas
3. **Implementation follows the schema** rather than the reverse

## Supported Schema Types

### OpenAPI 3.0 (✅ Currently Implemented)
- **Use Case**: REST APIs, HTTP services, Dapr actor APIs
- **Generation Target**: Go interfaces, types, schema validation
- **Tools**: Custom generators based on `kin-openapi`
- **Status**: Fully implemented and tested

### Future Support
Additional schema types can be added when needed:
- **Protocol Buffers**: For gRPC services and high-performance APIs
- **JSON Schema**: For data validation and simple type definitions  
- **GraphQL SDL**: For GraphQL APIs and flexible query interfaces
- **AsyncAPI**: For event-driven APIs and messaging systems

## Directory Structure

```
api-generation/                    # Schema-first development tools
├── schemas/openapi/               # OpenAPI 3.0 specifications (source)
├── tools/                         # Generation tools and scripts
│   ├── bin/                       # Installed tool binaries
│   └── scripts/                   # Installation and generation scripts
└── docs/                          # Documentation and examples

# Generated code is organized by actor type:
../internal/counteractor/          # Counter actor implementation and generated types
../internal/bankaccountactor/      # Bank account actor implementation and generated types
```

## Key Principles

### Separation of Concerns
1. **Schemas** (`schemas/`): Source of truth API schemas
2. **Tooling** (`tools/`): Generation and validation tools  
3. **Generated Code**: Output organized by actor type in respective packages
4. **Documentation** (`docs/`): Workflows, examples, and guidance

### Tool Installation Strategy
Only currently implemented tools are installed:
- ✅ **OpenAPI tools**: Custom generators based on `kin-openapi` (actively used and tested)
- ⏳ **Other tools**: Can be added when needed
│## Quick Start

### 1. Install Tools
```bash
cd api-generation
./tools/scripts/install.sh
```

### 2. Generate Code from Schema
```bash
# Generate from OpenAPI (only currently supported format)
./tools/scripts/generate.sh openapi schemas/openapi/multi-actors.yaml

# Generated code is now organized by actor type:
ls ../internal/counteractor/      # Counter actor types and interfaces
ls ../internal/bankaccountactor/  # Bank account actor types and interfaces
# types.go  generated.go  counter.go (or bankaccount.go)
```

### 3. Use Generated Code in Your Application
```go
import "github.com/shogotsuneto/dapr-actor-experiment/internal/counteractor"

func (c *CounterActor) Increment(ctx context.Context) (*counteractor.CounterState, error) {
    // Implementation MUST match the OpenAPI schema
}
```

## Integration with Main Server

The main Dapr server (`cmd/server`) uses the schema-based CounterActor implementation with generated OpenAPI types for type safety and schema compliance.

Check the `/status` endpoint to see actor information.